<div class="habits-container">
  <!-- –°–ø–∏—Å–æ–∫ –ø—Ä–∏–≤—ã—á–µ–∫ -->
  <div class="habits-grid">
    <mat-card *ngFor="let habit of habits" class="habit-card">
      <mat-card-header>
        <mat-card-title><strong>{{ habit.name }}</strong></mat-card-title>
      </mat-card-header>
      
      <mat-card-content>
        <!-- –û–ø–∏—Å–∞–Ω–∏–µ -->
        <p *ngIf="habit.description">{{ habit.description }}</p>
        
        <!-- –°—Ç—Ä–∏–∫ + –∫–Ω–æ–ø–∫–∞ –≥—Ä–∞—Ñ–∏–∫–∞ -->
        <div class="habit-header">
          <div class="streak">üî• –°—Ç—Ä–∏–∫: {{ getStreak(habit.id) }} –¥–Ω–µ–π</div>
          
          <!-- ‚úÖ –ö–ù–û–ü–ö–ê –ì–†–ê–§–ò–ö–ê -->
          <button mat-icon-button 
                  class="chart-toggle-btn"
                  (click)="selectHabit(habit.id)"
                  [class.active]="selectedHabitId === habit.id"
                  matTooltip="–ü–æ–∫–∞–∑–∞—Ç—å –≥—Ä–∞—Ñ–∏–∫ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –ø–æ –Ω–µ–¥–µ–ª—è–º">
            üìä
          </button>
        </div>

        <!-- –ù–µ–¥–µ–ª—å–Ω—ã–π —Ç—Ä–µ–∫–µ—Ä -->
        <div class="section-title">–ù–µ–¥–µ–ª—è</div>
        <div class="week-grid">
          <div *ngFor="let day of getWeeklyProgress(habit.id)" 
               class="day-cell"
               [class.completed]="day.completed"
               [class.today]="day.isToday"
               [class.disabled]="!day.isPastOrToday"
               (click)="day.isPastOrToday ? toggleDay(habit.id, day.date) : null">
            <div class="day-number">{{ day.date.split('-')[2] }}</div>
            <div class="day-name">{{ day.dayName }}</div>
          </div>
        </div>

        <!-- –ú–µ—Å—è—á–Ω—ã–π —Ç—Ä–µ–∫–µ—Ä -->
        <div class="section-title">–ú–µ—Å—è—Ü</div>
        <div class="month-grid">
          <!-- –ó–∞–≥–æ–ª–æ–≤–∫–∏ –¥–Ω–µ–π –Ω–µ–¥–µ–ª–∏ -->
          <div class="week-header">
            <div>–í—Å</div>
            <div>–ü–Ω</div>
            <div>–í—Ç</div>
            <div>–°—Ä</div>
            <div>–ß—Ç</div>
            <div>–ü—Ç</div>
            <div>–°–±</div>
          </div>

          <!-- –î–Ω–∏ –º–µ—Å—è—Ü–∞ -->
          <div class="days-grid">
            <div *ngFor="let cell of getMonthlyProgress(habit.id)"
                 class="month-day-cell"
                 [class.empty]="!cell.date"
                 [class.today]="cell.isToday"
                 [class.completed]="cell.completed"
                 [class.disabled]="!cell.isPast"
                 (click)="cell.date && cell.isPast ? toggleDay(habit.id, cell.date) : null">
              <span *ngIf="cell.date">{{ cell.date.split('-')[2] }}</span>
            </div>
          </div>
        </div>
      </mat-card-content>
      
      <mat-card-actions align="end">
        <button mat-button color="warn" (click)="deleteHabit(habit.id)">–£–¥–∞–ª–∏—Ç—å</button>
      </mat-card-actions>
    </mat-card>
  </div>

<div *ngIf="selectedHabitId" class="progress-section">
  <div class="section-header">
    <h3>üìä –ü—Ä–æ–≥—Ä–µ—Å—Å –ø–æ –Ω–µ–¥–µ–ª—è–º ‚Äî {{ selectedHabitName }}</h3>
    <button mat-icon-button (click)="closeChart()" matTooltip="–ó–∞–∫—Ä—ã—Ç—å">
      <mat-icon>close</mat-icon>
    </button>
  </div>

  <app-weekly-progress-chart
    [weeklyData]="getWeeklyHistoricalData(selectedHabitId)">
  </app-weekly-progress-chart>
</div>


<app-celebration></app-celebration> 
